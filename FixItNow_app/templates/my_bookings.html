{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container my-5">
    <p class="pb-3 mt-5 h4 fw-semibold text-primary border-bottom">My Bookings</p>

    <div class="mt-4">
        {% for booking in bookings %}
        <div class="row align-items-center py-4 border rounded shadow-sm mb-4 g-3 bg-white">
            
            <!-- Worker image -->
            <div class="col-12 col-sm-3 d-flex justify-content-center">
                {% if booking.worker.image %}
                <img src="{{ booking.worker.image }}" 
                     class="img-fluid rounded worker-img shadow-sm"
                     alt="{{ booking.worker.user.get_full_name }}">
                {% else %}
                <img src="{% static 'images/loginImage.jpg' %}" 
                     class="img-fluid rounded worker-img shadow-sm" 
                     alt="No image">
                {% endif %}
            </div>

            <!-- Worker details -->
            <div class="col-12 col-sm-6 text-muted">
                <p class="mb-1 fw-bold text-dark fs-5">{{ booking.worker.user.get_full_name }}</p>
                <p class="mb-1 text-capitalize">{{ booking.worker.worker_type }}</p>
                <p class="mt-2">
                    <span class="fw-semibold text-dark">üìÖ Date & Time:</span> 
                    {{ booking.booking_date|date:"d M Y" }} | {{ booking.booking_time|time:"h:i A" }}
                </p>
                <p class="mb-1"><strong>üìç Address:</strong> {{ booking.address|default:"N/A" }}</p>
                <p class="mb-1"><strong>üí¨ Message:</strong> {{ booking.message|default:"N/A" }}</p>
            </div>

            <!-- Action buttons -->
            <div class="col-12 col-sm-3 d-flex flex-column gap-2 align-items-center justify-content-center text-center">
                {% if booking.status == 'pending' %}
                <span class="badge bg-info text-white py-2 px-3 w-100">‚è≥ Pending</span>
                <a href="{% url 'cancel_booking' booking.id %}"  
                   style="text-decoration: none;" 
                   class="btn btn-outline-danger btn-sm w-100"
                   onclick="return confirm('Are you sure you want to cancel this booking?');">
                    Cancel Booking
                </a>
                {% elif booking.status == 'accepted' %}
                <span class="badge bg-success py-2 px-3 w-100">‚úÖ Accepted</span>
                {% elif booking.status == 'rejected' %}
                <span class="badge bg-danger py-2 px-3 w-100">‚ùå Rejected</span>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <p class="text-muted mt-3">You have no bookings yet.</p>
        {% endfor %}
    </div>
</div>

<!-- Custom styling -->
<style>
    .worker-img {
        width: 100%;
        max-width: 200px;
        height: 200px; 
        object-fit: cover; /* keeps face visible */
        border: 3px solid #f1f1f1;
    }
</style>
{% endblock %}
